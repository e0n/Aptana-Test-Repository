<!--
  User: Tobi
  Date: 24.10.2012
 -->

<!DOCTYPE html>
<html>
<head>
    <style>
        body {
            margin: 1px;
            padding: 1px;
        }
        canvas {
            border: 1px solid #c3c3c3;
        }
    </style>
    <script>
        //variable for the sum of Nodes - is on 2 because of 2 standard nodes already existing

        var markedNode;
        var markedNodeFillBackup;

        //Function for Mouse Location
        function writeMessage(messageLayer, message) {
            var context = messageLayer.getContext();
            messageLayer.clear();
            context.font = '18pt Calibri';
            context.fillStyle = 'black';
            context.fillText(message, 10, 25);
            context.fillText(sumOfNodes, 250, 25);
        }



        function clickNode(shape, layer) {
            markedNode.setFill(markedNodeFillBackup);
            markedNode = shape;
            markedNodeFillBackup = markedNode.getFill();
            markedNode.setFill('green');

            layer.draw();
        }

        //onload function
        window.onload = function() {
            var stage = new Kinetic.Stage({
                container: "container",
                width: 1024,
                height: 768
            });


            //Layer for shapes
            var layer = new Kinetic.Layer();
            // MessageLayer for Mouseposition and other debug notes
            var messageLayer = new Kinetic.Layer();

            // Oval Shape 1
            var base = newNodeFactory.createBaseNode(stage, layer);

            layer.add(base);

            markedNode = base;
            markedNodeFillBackup = base.getFill();

            //Oval Shape 2
            var oval2 = newNodeFactory.newEllipseNode(layer, base);

            //Button for FactoryMethod of creating new Nodes
            var newEllipseButton = debugGUI.buildNewEllipseButton();
            newEllipseButton.on("click", function(){
                newNodeFactory.newEllipseNode(layer, markedNode);
            });
            layer.add(newEllipseButton);

            var newRectButton = debugGUI.buildNewRectButton();
            newRectButton.on("click", function(){
                newNodeFactory.newRectNode(layer, markedNode);
            });
            layer.add(newRectButton);

            //function for mouse coordinates on shape - only for debugging and development
            stage.on("mousemove", function() {
                var mousePos = stage.getMousePosition();
                writeMessage(messageLayer, 'x: ' + mousePos.x + ', y: ' + mousePos.y);
            });

            // add the layer to the stage
            stage.add(layer);
            stage.add(messageLayer);
        };

    </script>
</head>
<body>

    <div id="container"></div>

</body>
</html>